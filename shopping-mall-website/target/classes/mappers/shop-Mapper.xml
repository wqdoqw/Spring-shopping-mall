<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="shopMapper">

	<!-- 상품 목록 -->
	<select id="goodsViewList"
		resultType="com.spring.myapp.domain.GoodsVO">
<![CDATA[
	SELECT goodsCode, 
	 	goodsName, 
	 	secondClassification, 
	 	brand, 
	 	goodsPrice,
     	goodsStock,
     	goodsDescription,
     	goodsImage,
     	goodsThumbnailImage,
     	goodsAddedTime
	FROM goods
        WHERE firstClassification = #{firstClassification}
]]>
	</select>

	<select id="goodsViewOne"
		resultType="com.spring.myapp.domain.GoodsVO">
<![CDATA[
	SELECT goodsCode,
	 	firstClassification, 
	 	secondClassification, 
	 	brand, 
	 	goodsPrice,
     	goodsStock,
     	goodsDescription,
     	goodsImage,
     	goodsThumbnailImage,
     	goodsAddedTime
	FROM goods
	WHERE goodsName = #{goodsName}
]]>
	</select>

	<!-- 상품 소감(댓글) 작성 -->
	<insert id="registerReply">
	<![CDATA[
		INSERT INTO goods_reply (goodsCode,
		goodsName,
		replyNumber,
		userid,
		replyData,
		replyRating)
			VALUES (#{goodsCode},
		#{goodsName},
		#{replyNumber},
		#{userid},
		#{replyData},
		#{replyRating})
	]]>
	</insert>
	<!-- 상품 소감(댓글) 리스트 -->
	<select id="replyList"
		resultType="com.spring.myapp.domain.GoodsReplyListVO">
		<![CDATA[
		SELECT r.goodsCode,
		r.goodsName,r.replyNumber,r.userid,r.replyData,
		r.replyDate, r.replyRating, m.username
		FROM goods_reply r INNER JOIN member m
		ON m.email = r.userid
		WHERE goodsName = #{goodsName}
		]]>
	</select>

	<!-- 상품 소감(댓글) 삭제 -->
	<delete id="deleteReply">
		DELETE FROM goods_reply 
		WHERE replyNumber = #{replyNumber}
	</delete>

	<!-- 아이디 체크 -->
	<select id="replyUserIdCheck" resultType="String">
		SELECT userid
		from goods_reply
		    where replyNumber = #{replyNumber}
	</select>
	
		<!-- 댓글 아이디로 찾기 -->
	<select id="replySelect" resultType="com.spring.myapp.domain.GoodsReplyVO">
		SELECT goodsCode,
				goodsName,
				replyNumber,
				userid,
				replyData,
				replyRating,
				replyDate
		FROM goods_reply WHERE replyNumber = #{replyNumber}
	</select>
	
	<!-- 댓글 수정 -->
	<update id="replyModify">
	<![CDATA[
	UPDATE goods_reply 
	 	SET replyData = #{replyData}, 
	 		replyRating = #{replyRating}
	WHERE replyNumber = #{replyNumber}
	]]>
	</update>
</mapper>
